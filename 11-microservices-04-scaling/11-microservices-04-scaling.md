
# Домашнее задание к занятию "11.04 Микросервисы: масштабирование"

Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.

## Задача 1: Кластеризация

<details>
    <summary style="font-size:18px">Описание:</summary>

Предложите решение для обеспечения развертывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- Поддержка контейнеров;
- Обеспечивать обнаружение сервисов и маршрутизацию запросов;
- Обеспечивать возможность горизонтального масштабирования;
- Обеспечивать возможность автоматического масштабирования;
- Обеспечивать явное разделение ресурсов доступных извне и внутри системы;
- Обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п.

Обоснуйте свой выбор.
</details>

<details>
    <summary style="font-size:18px">Ответ:</summary>

### Ответ:

Под указанные требования подойдет Kubernates.
- Поддержка контейнеров;
  - Возможность использования в качестве runtime: docker, containerd 
- Обеспечивать обнаружение сервисов и маршрутизацию запросов;
  - Обнаружение службы выполняется в Kubernetes с использованием автоматически созданных имен служб, соответствующих IP-адресу службы.
- Обеспечивать возможность горизонтального масштабирования;
  - горизонтальное автомасштабирование подов (Horizontal Pod Autoscaler, HPA), которое автоматически масштабирует количество подов в развертывании или наборе реплик.
- Обеспечивать возможность автоматического масштабирования;
  - Автомасштабирование кластера (Cluster Autoscaler, CA) изменяет количество узлов, исходя из количества ожидающих модулей pod. Система периодически проверяет наличие ожидающих модулей — и увеличивает размер кластера, если требуется больше ресурсов и если кластер не выходит за пределы установленных лимитов.
- Обеспечивать явное разделение ресурсов доступных извне и внутри системы;
  - Предоставление Kubernetes кластера узлов, который он может использовать для запуска контейнерных задач. Указание Kubernetes, сколько ЦП и памяти (ОЗУ) требуется каждому контейнеру. Kubernetes может разместить контейнеры на узлах так, чтобы наиболее эффективно использовать ресурсы.
- Обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п.
  - Kubernetes может хранить и управлять конфиденциальной информацией, такой как пароли, OAuth-токены и ключи SSH. 

Список литературы:  
https://kubernetes.io/ru/docs/concepts/_print/  
https://habr.com/ru/company/flant/blog/459326/  
https://ipsoftware.ru/posts-cloud/k8s-3-services/  
https://andreyex.ru/ubuntu/chto-takoe-obnaruzhenie-servisov-v-kubernetes/  

</details>

## Задача 2: Распределенный кэш * (необязательная)


<details>
    <summary style="font-size:18px">Описание:</summary>

Разработчикам вашей компании понадобился распределенный кэш для организации хранения временной информации по сессиям пользователей.
Вам необходимо построить Redis Cluster состоящий из трех шард с тремя репликами.

### Схема:

![11-04-01](https://user-images.githubusercontent.com/1122523/114282923-9b16f900-9a4f-11eb-80aa-61ed09725760.png)

</details>



<details>
    <summary style="font-size:18px">Ответ:</summary>

Проект по дополнительному заданию расположен в [additional](additional/)

Для проверки необходимо выполнить:

1) docker-compose up -d
2) ansible-playbook site.yml -i inventory/prod.yml



</details>

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---